parameters:
- name: platformName
  type: string
- name: domainResourceGroup
  type: string
  default: expertadomain
- name: domainName
  type: string
  default: experta.ca

steps:
  - task: ExpertaPreview.pvAzDNSZone.custom-build-release-task.ARecordManager@6
    displayName: 'Add A Dns record'
    inputs:
      azureSubscriptionEndpoint: 'Solutions Experta Internal (Pay-as-You-Go) (c613aec0-2955-4f3a-8682-c9fc4aa4a998)'
      resourceGroupName: ${{ parameters.domainResourceGroup }}
      domainName: ${{ parameters.domainName }}
      aName: ${{ parameters.platformName }}test
      ipAddress: 127.0.0.0
  - task: ExpertaPreview.pvAzDNSZone.custom-build-release-task.ARecordManager@6
    displayName: 'Update A Dns record'
    inputs:
      azureSubscriptionEndpoint: 'Solutions Experta Internal (Pay-as-You-Go) (c613aec0-2955-4f3a-8682-c9fc4aa4a998)'
      resourceGroupName: ${{ parameters.domainResourceGroup }}
      domainName: ${{ parameters.domainName }}
      aName: ${{ parameters.platformName }}test
      ipAddress: 127.0.0.1
  - task: ExpertaPreview.pvAzDNSZone.custom-build-release-task.ARecordManager@6
    displayName: 'Remove A Dns record'
    inputs:
      azureSubscriptionEndpoint: 'Solutions Experta Internal (Pay-as-You-Go) (c613aec0-2955-4f3a-8682-c9fc4aa4a998)'
      actionType: remove
      resourceGroupName: ${{ parameters.domainResourceGroup }}
      domainName: ${{ parameters.domainName }}
      aName: ${{ parameters.platformName }}test
  - task: ExpertaPreview.pvAzDNSZone.cnameRecord-task.CNAMERecordManager@6
    displayName: 'Add CNAME Dns record'
    inputs:
      azureSubscriptionEndpoint: 'Solutions Experta Internal (Pay-as-You-Go) (c613aec0-2955-4f3a-8682-c9fc4aa4a998)'
      actionType: createUpdate
      resourceGroupName: ${{ parameters.domainResourceGroup }}
      domainName: ${{ parameters.domainName }}
      cname: ${{ parameters.platformName }}test
      alias: ${{ parameters.domainName }}
  - task: ExpertaPreview.pvAzDNSZone.cnameRecord-task.CNAMERecordManager@6
    displayName: 'Update CNAME Dns record'
    inputs:
      azureSubscriptionEndpoint: 'Solutions Experta Internal (Pay-as-You-Go) (c613aec0-2955-4f3a-8682-c9fc4aa4a998)'
      actionType: createUpdate
      resourceGroupName: ${{ parameters.domainResourceGroup }}
      domainName: ${{ parameters.domainName }}
      cname: ${{ parameters.platformName }}test
      alias: expertasolutions.com
  - task: ExpertaPreview.pvAzDNSZone.cnameRecord-task.CNAMERecordManager@6
    displayName: 'Remove CNAME Dns record'
    inputs:
      azureSubscriptionEndpoint: 'Solutions Experta Internal (Pay-as-You-Go) (c613aec0-2955-4f3a-8682-c9fc4aa4a998)'
      actionType: remove
      resourceGroupName: ${{ parameters.domainResourceGroup }}
      domainName: ${{ parameters.domainName }}
      cname: ${{ parameters.platformName }}test
  - task: ExpertaPreview.pvAzDNSZone.txtRecord-task.TXTRecordManager@6
    displayName: 'Create ''${{ parameters.platformName }}Test'' TXT DNS record on experta.ca'
    inputs:
      azureSubscriptionEndpoint: 'Solutions Experta Internal (Pay-as-You-Go) (c613aec0-2955-4f3a-8682-c9fc4aa4a998)'
      resourceGroupName: ${{ parameters.domainResourceGroup }}
      domainName: ${{ parameters.domainName }}
      txt: ${{ parameters.platformName }}Test
      value: |
        invalid1
        invalid2
  - task: ExpertaPreview.pvAzDNSZone.txtRecord-task.TXTRecordManager@6
    displayName: 'Update ''${{ parameters.platformName }}Test'' TXT DNS record on experta.ca'
    inputs:
      azureSubscriptionEndpoint: 'Solutions Experta Internal (Pay-as-You-Go) (c613aec0-2955-4f3a-8682-c9fc4aa4a998)'
      resourceGroupName: ${{ parameters.domainResourceGroup }}
      domainName: ${{ parameters.domainName }}
      txt: ${{ parameters.platformName }}Test
      value: |
        invalidupdate1
        invalidupdate2
  - task: ExpertaPreview.pvAzDNSZone.txtRecord-task.TXTRecordManager@6
    displayName: 'Remove ''${{ parameters.platformName }}Test'' TXT DNS record on experta.ca'
    inputs:
      azureSubscriptionEndpoint: 'Solutions Experta Internal (Pay-as-You-Go) (c613aec0-2955-4f3a-8682-c9fc4aa4a998)'
      actionType: remove
      resourceGroupName: ${{ parameters.domainResourceGroup }}
      domainName: ${{ parameters.domainName }}
      txt: ${{ parameters.platformName }}Test